{% extends 'base.html' %}

{% block main %}
{% if current_user.is_authenticated %}
    <h1>Hello {{ current_user.first_name }}</h1>
{% else %}
    <h1>Welcome</h1>
{% endif %}

<div class="feed">
    {% for event in events %}
        {% if event.activities %}
            {% for activity in event.activities %}
                <div class="log">
                    <div class="profile_picture">
                        {% for child in event.children %}
                        <img src="{{ url_for('static', filename='profile_pics/' + child.picture) }}" alt="Child Picture">
                        {% endfor %}
                    </div>
                    <div class="activity">
                        <h4>Activity</h4>
                        <p class="description">
                            {{ activity.description }}
                        </p>
                        <p class="timestamp">
                            {{ event.event_time|format_date }}
                        </p>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
        {% if event.sleeps %}
            {% for sleep in event.sleeps %}
                <div class="log">
                    <div class="profile_picture">
                        {% for child in event.children %}
                        <img src="{{ url_for('static', filename='profile_pics/' + child.picture) }}" alt="Child Picture">
                    </div>
                    <div class="sleep">
                        <h4>Sleep</h4>
    
                        <p class="description">
                            {{child.first_name}} went to sleep at {{ sleep.sleep_start }} and woke up at {{ sleep.sleep_end }}.
                        </p>
                        {% endfor %}
                        <p class="timestamp">
                            {{ event.event_time|format_date }}
                        </p>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
        {% if event.foods %}
            {% for food in event.foods %}
                <div class="log">
                    <div class="profile_picture">
                        {% for child in event.children %}
                            <img src="{{ url_for('static', filename='profile_pics/' + child.picture) }}" alt="Child Picture">
                    </div>
                    <div class="food">
                        <h4>{{ food.meal_type | capitalize }}</h4>
    
                        <p class="description">
                            {{child.first_name}} had {{ food.description }} for their {{ food.meal_type }}.
                        </p>
                        {% endfor %}
                        {% if food.picture %}
                            <img src="{{ url_for('static', filename='food_pics/' + food.picture) }}" alt="Food">
                        {% endif %}

                        <p class="timestamp">
                            {{ event.event_time|format_date }}
                        </p>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
        {% if event.developmentals %}
            {% for developmental in event.developmentals %}
                <div class="log">
                    <div class="profile_picture">
                        {% for child in event.children %}
                            <img src="{{ url_for('static', filename='profile_pics/' + child.picture) }}" alt="Child Picture">
                    </div>
                    <div class="developmental">
                        <h4>Developmental Milestone</h4>
    
                        <p class="description">
                            {{child.first_name}} {{developmental.description}}.
                        </p>
                        {% endfor %}
                        {% if developmental.picture %}
                            <img src="{{ url_for('static', filename='event_pics/' + food.picture) }}" alt="Developmental">
                        {% endif %}

                        <p class="timestamp">
                            {{ event.event_time|format_date }}
                        </p>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
        {% if event.incidents %}
            {% for incident in event.incidents %}
                <div class="log">
                    <div class="profile_picture">
                        {% for child in event.children %}
                            <img src="{{ url_for('static', filename='profile_pics/' + child.picture) }}" alt="Child Picture">
                    </div>
                    <div class="incident">
                        <h4>{{ incident.incident_type | capitalize }}</h4>
    
                        <p class="description">
                            {{incident.description}}
                        </p>
                        {% endfor %}

                        <p class="timestamp">
                            {{ event.event_time|format_date }}
                        </p>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
        {% if event.medications %}
            {% for medication in event.medications %}
                <div class="log">
                    <div class="profile_picture">
                        {% for child in event.children %}
                            <img src="{{ url_for('static', filename='profile_pics/' + child.picture) }}" alt="Child Picture">
                    </div>
                    <div class="medication">
                        <h4>Medication</h4>
    
                        <p class="description">
                            {{ child.first_name }} was given {{ medication.amount }} of {{ medication.medication_name }} at {{ medication.time_given }}
                            {% if medication.reason %}
                                due to {{ medication.reason }}
                            {% endif %}
                        </p>
                        {% endfor %}

                        <p class="timestamp">
                            {{ event.event_time|format_date }}
                        </p>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
        {% if event.nappies %}
            {% for nappy in event.nappies %}
                <div class="log">
                    <div class="profile_picture">
                        {% for child in event.children %}
                            <img src="{{ url_for('static', filename='profile_pics/' + child.picture) }}" alt="Child Picture">
                    </div>
                    <div class="nappy">
                        <h4>{{ nappy.nappy_type | capitalize }}</h4>
    
                        <p class="description">
                            {% if nappy.nappy_type == "nappy" %}
                                {{ child.first_name }} had a nappy change.
                            {% elif nappy.nappy_type == "potty" %}
                                {{ child.first_name }} used the potty.
                            {% endif %}
                        </p>
                        <br>
                        <p>
                            {% if nappy.condition %}
                                Additional info: {{ nappy.condition }}
                            {% endif %}
                        </p>
                        {% endfor %}

                        <p class="timestamp">
                            {{ event.event_time|format_date }}
                        </p>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
        {% if event.notes %}
            {% for note in event.notes %}
                <div class="log">
                    <div class="profile_picture">
                        {% for child in event.children %}
                            <img src="{{ url_for('static', filename='profile_pics/' + child.picture) }}" alt="Child Picture">
                    </div>
                    <div class="note">
                        <h4>Note</h4>
    
                        <p class="description">
                            {{  note.description }}
                        </p>
                        {% endfor %}

                        <p class="timestamp">
                            {{ event.event_time|format_date }}
                        </p>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
    {% endfor %}
</div>


<h2><a href="{{ url_for('activities') }}">Activities</a></h2>
<h2><a href="{{ url_for('developmental') }}">Developmental</a></h2>
<h2><a href="{{ url_for('food') }}">Food</a></h2>
<h2><a href="{{ url_for('incident') }}">Incident</a></h2>
<h2><a href="{{ url_for('medication') }}">Medication</a></h2>
<h2><a href="{{ url_for('nappy') }}">Nappy</a></h2>
<h2><a href="{{ url_for('note') }}">Note</a></h2>
<h2><a href="{{ url_for('sleep') }}">Sleep</a></h2>
{% endblock %}